<div class="builder">
	<div class="builder-grid">

		<div class="preview-section">
			<div class="preview-header">
				<h2>Live Preview</h2>
			</div>
			<div class="preview-container">
				@for (dummy of [configKey]; track dummy) {
					<ngx-analog-clock [config]="config"></ngx-analog-clock>
				}
			</div>
		</div>

		<div class="config-section">
			<div class="config-header">
				<h2>Configuration</h2>
				<div class="config-actions">
					<button class="btn-primary show" (click)="openModal()">Show Config</button>
					<button class="btn-primary" (click)="resetToDefaults()">Reset</button>
				</div>
			</div>
			
			<div class="config-form">
				<div class="form-group">
					<h3>Basic Settings</h3>
					<label>
						<span>Size (px)</span>
						<input 
							type="range" 
							min="100" 
							max="500" 
							[(ngModel)]="size"
							(ngModelChange)="forceUpdate()">
						<span class="value">{{size}}</span>
					</label>

					<label>
						<span>Theme</span>
						<select 
							[(ngModel)]="theme"
							(ngModelChange)="onThemeChange()">
							<option value="light">Light</option>
							<option value="dark">Dark</option>
							<option value="custom">Custom</option>
						</select>
					</label>

					<label>
						<span>Timezone</span>
						<input 
							type="text" 
							[(ngModel)]="timezone"
							(ngModelChange)="forceUpdate()"
							placeholder="e.g. America/New_York, Europe/London, Asia/Tokyo">
					</label>

					<div class="info-box" *ngIf="theme !== 'custom'">
						<span class="info-icon">ðŸ’¡</span>
						<span class="info-text">
							<strong>Tip:</strong> Switch to <strong>Custom</strong> theme for unlimited color customization and gradient backgrounds!
						</span>
					</div>
				</div>

				<div class="form-group">
					<h3>Hands</h3>
					<h4>Hour Hand</h4>
					<label>
						<span>Show Hand</span>
						<input 
							type="checkbox" 
							[(ngModel)]="hourShow"
							(ngModelChange)="forceUpdate()">
					</label>

					<label>
						<span>Length</span>
						<input 
							type="range" 
							min="0.1" 
							max="1.0" 
							step="0.05" 
							[(ngModel)]="hourLength"
							(ngModelChange)="forceUpdate()">
						<span class="value">{{formatLength(hourLength)}}</span>
					</label>

					<label>
						<span>Width (px)</span>
						<input 
							type="range" 
							min="1" 
							max="15" 
							[(ngModel)]="hourWidth"
							(ngModelChange)="forceUpdate()">
						<span class="value">{{hourWidth}}</span>
					</label>

					<h4 style="margin-top: 36px;">Minute Hand</h4>
					<label>
						<span>Show Hand</span>
						<input 
							type="checkbox" 
							[(ngModel)]="minuteShow"
							(ngModelChange)="forceUpdate()">
					</label>

					<label>
						<span>Length</span>
						<input 
							type="range" 
							min="0.1" 
							max="1.0" 
							step="0.05" 
							[(ngModel)]="minuteLength"
							(ngModelChange)="forceUpdate()">
						<span class="value">{{formatLength(minuteLength)}}</span>
					</label>

					<label>
						<span>Width (px)</span>
						<input 
							type="range" 
							min="1" 
							max="15" 
							[(ngModel)]="minuteWidth"
							(ngModelChange)="forceUpdate()">
						<span class="value">{{minuteWidth}}</span>
					</label>

					<h4 style="margin-top: 36px;">Second Hand</h4>
					<label>
						<span>Show Hand</span>
						<input 
							type="checkbox" 
							[(ngModel)]="secondShow"
							(ngModelChange)="forceUpdate()">
					</label>

					<label>
						<span>Smooth Animation</span>
						<input 
							type="checkbox" 
							[(ngModel)]="smooth"
							(ngModelChange)="forceUpdate()">
						</label>

					<label>
						<span>Length</span>
						<input 
							type="range" 
							min="0.1" 
							max="1.0" 
							step="0.05" 
							[(ngModel)]="secondLength"
							(ngModelChange)="forceUpdate()">
						<span class="value">{{formatLength(secondLength)}}</span>
					</label>

					<label>
						<span>Width (px)</span>
						<input 
							type="range" 
							min="1" 
							max="15" 
							[(ngModel)]="secondWidth"
							(ngModelChange)="forceUpdate()">
						<span class="value">{{secondWidth}}</span>
					</label>
				</div>

				<div class="form-group">
					<h3>Display</h3>
					
					<label>
						<span>Markers</span>
						<select 
							[(ngModel)]="markers"
							(ngModelChange)="forceUpdate()">
							<option value="lines">Lines</option>
							<option value="numbers">Numbers</option>
							<option value="both">Both</option>
							<option value="none">None</option>
						</select>
					</label>

					<label *ngIf="markers === 'numbers' || markers === 'both'">
						<span>Number Style</span>
						<select 
							[(ngModel)]="numberStyle"
							(ngModelChange)="forceUpdate()">
							<option value="standard">Standard (1-12)</option>
							<option value="roman">Roman (I-XII)</option>
						</select>
					</label>

					<label *ngIf="markers === 'lines' || markers === 'both'">
						<span>Hour Marker Width</span>
						<input 
							type="range" 
							min="1" 
							max="10" 
							[(ngModel)]="hourMarkerWidth"
							(ngModelChange)="forceUpdate()">
						<span class="value">{{hourMarkerWidth}}</span>
					</label>

					<label *ngIf="markers === 'lines' || markers === 'both'">
						<span>Minute Marker Width</span>
						<input 
							type="range" 
							min="0" 
							max="5" 
							[(ngModel)]="minuteMarkerWidth"
							(ngModelChange)="forceUpdate()">
						<span class="value">{{minuteMarkerWidth}}</span>
					</label>

					<label *ngIf="markers === 'numbers' || markers === 'both'">
						<span>Number Size</span>
						<input 
							type="range" 
							min="10" 
							max="24" 
							[(ngModel)]="numberSize"
							(ngModelChange)="forceUpdate()">
						<span class="value">{{numberSize}}</span>
					</label>

					<label *ngIf="markers === 'numbers' || markers === 'both'">
						<span>Number Weight</span>
						<select 
							[(ngModel)]="numberWeight"
							(ngModelChange)="forceUpdate()">
							<option value="light">Light</option>
							<option value="normal">Normal</option>
							<option value="bold">Bold</option>
						</select>
					</label>

					<label>
						<span>Show Border</span>
						<input 
							type="checkbox" 
							[(ngModel)]="showBorder"
							(ngModelChange)="forceUpdate()">
					</label>

					<label *ngIf="showBorder && theme === 'custom'">
						<span>Border Width</span>
						<input 
							type="range" 
							min="1" 
							max="20" 
							[(ngModel)]="borderWidth"
							(ngModelChange)="forceUpdate()">
						<span class="value">{{borderWidth}}</span>
					</label>

					<label>
						<span>Show Inner Ring</span>
						<input 
							type="checkbox" 
							[(ngModel)]="showInnerRing"
							(ngModelChange)="forceUpdate()">
					</label>

					<label>
						<span>Show Center Ring</span>
						<input 
							type="checkbox" 
							[(ngModel)]="showCenterRing"
							(ngModelChange)="forceUpdate()">
					</label>
				</div>

				<div class="form-group">
					<h3>Digital Display</h3>

					<label>
						<span>Show Digital Display</span>
						<input 
							type="checkbox" 
							[(ngModel)]="showDigitalDisplay"
							(ngModelChange)="forceUpdate()">
					</label>

					<label *ngIf="showDigitalDisplay">
						<span>Format</span>
						<select 
							[(ngModel)]="digitalFormat"
							(ngModelChange)="forceUpdate()">
							<option value="12h">12 Hour</option>
							<option value="24h">24 Hour</option>
						</select>
					</label>

					<label *ngIf="showDigitalDisplay">
						<span>Show Seconds</span>
						<input 
							type="checkbox" 
							[(ngModel)]="digitalShowSeconds"
							(ngModelChange)="forceUpdate()">
					</label>

					<label *ngIf="showDigitalDisplay">
						<span>Show Date</span>
						<input 
							type="checkbox" 
							[(ngModel)]="digitalShowDate"
							(ngModelChange)="forceUpdate()">
					</label>

					<label *ngIf="showDigitalDisplay && theme === 'custom'">
						<span>Digital Color</span>
						<input 
							type="color" 
							[(ngModel)]="digitalColor"
							(ngModelChange)="forceUpdate()">
					</label>
				</div>

				<div class="form-group">
					<h3>Label</h3>
					
					<label>
						<span>Text</span>
						<input 
							type="text" 
							[(ngModel)]="labelText"
							(ngModelChange)="forceUpdate()"
							placeholder="Enter label text">
					</label>

					<label *ngIf="hasLabel">
						<span>Position</span>
						<select 
							[(ngModel)]="labelPosition"
							(ngModelChange)="forceUpdate()">
							<option value="top">Top</option>
							<option value="bottom">Bottom</option>
						</select>
					</label>
				</div>

				<div class="form-group" *ngIf="theme === 'custom'">
					<h3>Custom Colors</h3>

					<label style="margin-bottom: 12px;">
						<span>Use Custom Colors</span>
						<input 
							type="checkbox" 
							[(ngModel)]="useCustomColors"
							(ngModelChange)="onUseCustomColorsChange()">
					</label>

					<div class="custom-colors-section" *ngIf="useCustomColors">
					<h4>Hands</h4>
					<label>
						<span>Hour Hand</span>
						<input 
							type="color" 
							[(ngModel)]="customHourHand"
							(ngModelChange)="forceUpdate()">
					</label>

					<label>
						<span>Minute Hand</span>
						<input 
							type="color" 
							[(ngModel)]="customMinuteHand"
							(ngModelChange)="forceUpdate()">
					</label>

					<label>
						<span>Second Hand</span>
						<input 
							type="color" 
							[(ngModel)]="customSecondHand"
							(ngModelChange)="forceUpdate()">
					</label>

					<h4>Markers</h4>
					<label>
						<span>Hour Markers</span>
						<input 
							type="color" 
							[(ngModel)]="customHourMarker"
							(ngModelChange)="forceUpdate()">
					</label>

					<label>
						<span>Minute Markers</span>
						<input 
							type="color" 
							[(ngModel)]="customMinuteMarker"
							(ngModelChange)="forceUpdate()">
					</label>

					<h4>Center</h4>
					<label>
						<span>Center Dot</span>
						<input 
							type="color" 
							[(ngModel)]="customCenterDot"
							(ngModelChange)="forceUpdate()">
					</label>

					<label>
						<span>Center Ring</span>
						<input 
							type="color" 
							[(ngModel)]="customCenterRing"
							(ngModelChange)="forceUpdate()">
					</label>

					<h4 style="margin: 24px 0px;">Background & Border</h4>
					<label>
						<span>Use Gradient</span>
						<input 
							type="checkbox" 
							[(ngModel)]="useGradient"
							(ngModelChange)="forceUpdate()">
					</label>

					<div *ngIf="!useGradient">
						<label style="margin-bottom: 12px;">
						<span>Background</span>
						<input 
							type="color" 
							[(ngModel)]="customBackground"
							(ngModelChange)="forceUpdate()">
						</label>
					</div>

					<div *ngIf="useGradient">
						<label>
							<span>Gradient Type</span>
							<select 
								[(ngModel)]="gradientType"
								(ngModelChange)="forceUpdate()">
								<option value="linear">Linear</option>
								<option value="radial">Radial</option>
							</select>
						</label>

						<label>
							<span>Start Color</span>
							<input 
								type="color" 
								[(ngModel)]="gradientStart"
								(ngModelChange)="forceUpdate()">
						</label>

						<label style="margin-bottom: 12px;">
							<span>End Color</span>
							<input 
								type="color" 
								[(ngModel)]="gradientEnd"
								(ngModelChange)="forceUpdate()">
						</label>

						<label *ngIf="gradientType === 'linear'" style="margin-bottom: 12px;">
							<span>Angle (deg)</span>
							<input 
								type="range" 
								min="0" 
								max="360" 
								[(ngModel)]="gradientAngle"
								(ngModelChange)="forceUpdate()">
							<span class="value">{{gradientAngle}}Â°</span>
						</label>
					</div>

					<label>
						<span>Border</span>
						<input 
							type="color" 
							[(ngModel)]="customBorder"
							(ngModelChange)="forceUpdate()">
					</label>

					<label>
						<span>Inner Ring</span>
							<input 
							type="color" 
							[(ngModel)]="customInnerRing"
							(ngModelChange)="forceUpdate()">
					</label>

					<label *ngIf="hasLabel">
						<span>Label Color</span>
							<input 
							type="color" 
							[(ngModel)]="customLabel"
							(ngModelChange)="forceUpdate()">
					</label>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
	<div class="modal-content" (click)="$event.stopPropagation()">
		<div class="modal-header">
			<h2>Generated Config</h2>
			<div class="modal-actions">
				<button (click)="copyToClipboard()" class="btn-copy">
					{{ copied ? 'âœ“ Copied!' : 'ðŸ“‹ Copy Config' }}
				</button>
				<button (click)="closeModal()" class="btn-close">Ã—</button>
			</div>
		</div>
		<div class="modal-body">
			<pre><code>{{generatedCode}}</code></pre>
		</div>
	</div>
</div>